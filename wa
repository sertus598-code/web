<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Test Grilă – Avansat</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; background: #f0f0f0; }
    #quiz-box { background: white; padding: 30px; max-width: 600px; margin: auto; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .question { font-size: 1.2em; margin-bottom: 20px; }
    .answers button {
      display: block;
      margin: 8px 0;
      padding: 12px;
      width: 100%;
      background-color: #eee;
      border: 1px solid #ccc;
      cursor: pointer;
      border-radius: 4px;
      transition: 0.2s;
    }
    .answers button:hover { background-color: #ddd; }
    #next-btn, #restart-btn {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #5865F2;
      color: white;
      border: none;
      border-radius: 4px;
      display: none;
    }
    #timer { margin-top: 10px; font-weight: bold; color: #c92a2a; }
    #score { margin-top: 30px; font-weight: bold; }
  </style>
</head>
<body>

<div id="quiz-box">
  <div class="question" id="question">Încărcare întrebare...</div>
  <div id="timer"></div>
  <div class="answers" id="answers"></div>
  <button id="next-btn" onclick="nextQuestion()">Următoarea întrebare</button>
  <div id="score"></div>
  <button id="restart-btn" onclick="restartQuiz()">Reîncepe Testul</button>
</div>

<script>
  const WEBHOOK_URL = "https://discord.com/api/webhooks/XXX/YYY"; // 🔁 Înlocuiește cu webhookul tău

  const questions = [
    { question: "Care organ filtrează sângele?", answers: ["Plămânii", "Ficatul", "Rinichii", "Creierul"], correct: 2 },
    { question: "Câte vertebre are coloana umană?", answers: ["24", "26", "33", "36"], correct: 2 },
    { question: "Ce tip de sânge e receptor universal?", answers: ["A", "O", "AB", "B"], correct: 2 }
  ];

  let current = 0;
  let score = 0;
  let timeLeft = 15;
  let timerInterval;
  let shuffledQuestions = [];

  function shuffle(array) {
    return array.sort(() => Math.random() - 0.5);
  }

  function loadQuestion() {
    clearInterval(timerInterval);
    timeLeft = 15;
    document.getElementById("timer").textContent = `Timp rămas: ${timeLeft}s`;
    timerInterval = setInterval(updateTimer, 1000);

    const q = shuffledQuestions[current];
    document.getElementById("question").textContent = q.question;
    const answersDiv = document.getElementById("answers");
    answersDiv.innerHTML = "";

    q.answers.forEach((ans, index) => {
      const btn = document.createElement("button");
      btn.textContent = ans;
      btn.onclick = () => checkAnswer(index);
      answersDiv.appendChild(btn);
    });

    document.getElementById("next-btn").style.display = "none";
    document.getElementById("score").textContent = "";
  }

  function updateTimer() {
    timeLeft--;
    document.getElementById("timer").textContent = `Timp rămas: ${timeLeft}s`;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      checkAnswer(null); // nu a răspuns
    }
  }

  function checkAnswer(selected) {
    clearInterval(timerInterval);
    const correct = shuffledQuestions[current].correct;
    const buttons = document.querySelectorAll(".answers button");

    buttons.forEach((btn, idx) => {
      btn.disabled = true;
      btn.style.backgroundColor = idx === correct ? "#b2f2bb" : (idx === selected ? "#ffa8a8" : "#eee");
    });

    if (selected === correct) score++;

    document.getElementById("next-btn").style.display = "inline-block";
  }

  function nextQuestion() {
    current++;
    if (current < shuffledQuestions.length) {
      loadQuestion();
    } else {
      showScore();
    }
  }

  function showScore() {
    const total = shuffledQuestions.length;
    document.getElementById("quiz-box").innerHTML = `
      <h2>Test finalizat!</h2>
      <p>Ai obținut <strong>${score}</strong> din <strong>${total}</strong>.</p>
      <p>Scorul tău a fost salvat local și trimis pe Discord.</p>
      <button onclick="restartQuiz()">Reîncepe Testul</button>
    `;

    // Salvare în localStorage
    localStorage.setItem("lastScore", `${score}/${total}`);

    // Trimitere pe Discord
    fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        content: `📊 Scor final: ${score}/${total} (utilizator anonim)`
      })
    });
  }

  function restartQuiz() {
    location.reload();
  }

  // START
  shuffledQuestions = shuffle(questions);
  loadQuestion();
</script>

</body>
</html>
